% Author: Abid H. Mujtaba (Dept. of Physics, CIIT-Islamabad)
% Email: abid.mujtaba@comsats.edu.pk

% We define all style related instructions for formatting CIIT Dissertations inside this package

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{ciit-dissertation}[2016/05/08]


\RequirePackage{biblatex}
\RequirePackage{emptypage}      % suppress page numbers of empty pages
\RequirePackage{fancyhdr}       % used to style the page numbers
\RequirePackage[margin=1in]{geometry}
\RequirePackage[double spacing]{set space}


% Rename the Bibliography title to read "References"
\DefineBibliographyStrings{english}{bibliography={References},}


% Ensure that ALL page numbers are in the footer on the right
\pagestyle{fancy}
% Clear the header and footer
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}      % Remove the horizontal line from the top
% Place the page number
\fancyfoot[R]{\thepage}

% We also need to redefine the style for chapter title pages
\fancypagestyle{plain}{%
    \renewcommand{\headrulewidth}{0pt}
    \fancyhf{}
    \fancyfoot[R]{\thepage}
}


\makeatletter

% Define a macro that takes two arguments. Only if the first is non-empty will the second be executed.
\newcommand{\ifnotempty}[2]{
    \ifx#1\empty                % if #1 is empty then (skipped to 'else' which is executed when #1 is non-empty)
    \else
        \expandafter#2          % \expandafter ensures that #2 is expanded after the conditional is evaluated so that the correct order is followed
    \fi
}

% Define the global variables and macros for populating them. These are used to specify the content of the front matter.
\def\@dedication{}
\def\@acknowledgement{}
\def\@abstract{}

\newcommand{\dedication}[1]{\def\@dedication{#1}}
\newcommand{\acknowledgement}[1]{\def\@acknowledgement{#1}}
\newcommand{\abstract}[1]{\def\@abstract{#1}}


% Define the command for creating ALL of the front matter right up to the first chapter
\newcommand{\makefrontmatter}{

    \maketitle

    % Create the dedication page (but only if \@dedication is non-empty)
    \ifnotempty{\@dedication}{%
        \cleardoublepage            % Creates a new page ensuring that if needed an empty page is inserted to ensure the following is on an odd page
        \vspace*{3cm}               % Empty space above the dedication text
        \thispagestyle{empty}       % Remove all formatting and styling from the current page
        \begin{center}
            \Large \emph{\@dedication}      % The dedication is centered horizontally and is italicized
        \end{center}
    }

    % Consists of the Acknowledgement, Abstract .etc
    \frontmatter

    \ifnotempty{\@acknowledgement}{
        \cleardoublepage
        \chapter{Acknowledgement}
        \@acknowledgement
    }

    \ifnotempty{\@abstract}{
        \cleardoublepage
        \chapter{Abstract}
        \@abstract
    }

    \tableofcontents

    \addcontentsline{toc}{chapter}{List of Figures}
    \listoffigures

    % Declare that the main matter is starting
    \mainmatter
}


% Define command for creating the references
\newcommand{\makereferences}{

    \addcontentsline{toc}{chapter}{References}      % Add references to ToC
    \printbibliography
}

\makeatother
